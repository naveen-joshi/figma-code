<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Figma → Code Generator</title>
    <meta name="description" content="Generate Angular or React components from Figma designs using AI">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/jsx/jsx.min.js"></script>
</head>

<body>
    <!-- ─── Header ──────────────────────────────────── -->
    <header class="app-header">
        <div class="header-brand">
            <div class="logo">
                <svg width="28" height="28" viewBox="0 0 28 28" fill="none">
                    <rect width="28" height="28" rx="6" fill="url(#grad)" />
                    <path d="M8 10L14 6L20 10V18L14 22L8 18V10Z" stroke="white" stroke-width="1.5" fill="none" />
                    <circle cx="14" cy="14" r="3" fill="white" opacity="0.9" />
                    <defs>
                        <linearGradient id="grad" x1="0" y1="0" x2="28" y2="28">
                            <stop stop-color="#6366f1" />
                            <stop offset="1" stop-color="#8b5cf6" />
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <div class="brand-text">
                <h1>Figma → Code</h1>
                <span class="badge">AI-Powered</span>
            </div>
        </div>
        <div class="header-actions">
            <a href="https://github.com" target="_blank" class="icon-link" title="GitHub">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.44 9.8 8.21 11.39.6.11.79-.26.79-.58v-2.17c-3.34.73-4.03-1.42-4.03-1.42-.55-1.39-1.34-1.76-1.34-1.76-1.09-.74.08-.73.08-.73 1.2.09 1.84 1.24 1.84 1.24 1.07 1.84 2.81 1.31 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.12-.3-.54-1.52.12-3.18 0 0 1.01-.32 3.3 1.23a11.5 11.5 0 016.02 0c2.28-1.55 3.29-1.23 3.29-1.23.66 1.66.24 2.88.12 3.18.77.84 1.24 1.91 1.24 3.22 0 4.61-2.81 5.63-5.48 5.92.43.37.81 1.1.81 2.22v3.29c0 .32.19.7.8.58A12.01 12.01 0 0024 12c0-6.63-5.37-12-12-12z" />
                </svg>
            </a>
        </div>
    </header>

    <!-- ─── Main Content ────────────────────────────── -->
    <main class="app-main">
        <!-- Left Panel: Input -->
        <section class="panel panel-input">
            <div class="panel-header">
                <h2>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <polyline points="14 2 14 8 20 8" />
                    </svg>
                    Input
                </h2>
            </div>

            <div class="panel-body">
                <!-- Framework Selector -->
                <div class="framework-selector">
                    <span class="fw-label">Framework</span>
                    <div class="fw-pills">
                        <button class="fw-pill active" data-framework="angular" id="fwAngular">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M12 2L2 7l1.5 12.5L12 22l8.5-2.5L22 7L12 2zm0 2.16L18.76 7 12 19.25 5.24 7 12 4.16z" />
                            </svg>
                            Angular
                        </button>
                        <button class="fw-pill" data-framework="react" id="fwReact">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="2.5" />
                                <ellipse cx="12" cy="12" rx="10" ry="4" fill="none" stroke="currentColor"
                                    stroke-width="1" />
                                <ellipse cx="12" cy="12" rx="10" ry="4" fill="none" stroke="currentColor"
                                    stroke-width="1" transform="rotate(60 12 12)" />
                                <ellipse cx="12" cy="12" rx="10" ry="4" fill="none" stroke="currentColor"
                                    stroke-width="1" transform="rotate(120 12 12)" />
                            </svg>
                            React
                        </button>
                    </div>
                </div>

                <!-- Source tabs -->
                <div class="source-tabs">
                    <button class="source-tab active" data-source="figma-url">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                        </svg>
                        Figma URL
                    </button>
                    <button class="source-tab" data-source="json-paste">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14 2 14 8 20 8" />
                        </svg>
                        Paste JSON
                    </button>
                </div>

                <!-- Figma URL source -->
                <div class="source-panel active" id="figmaUrlPanel">
                    <div class="form-group">
                        <label for="figmaUrlInput">Figma File URL</label>
                        <input type="url" id="figmaUrlInput"
                            placeholder="https://www.figma.com/design/ABC123xyz/My-Project" spellcheck="false">
                        <span class="input-hint">Paste any Figma file, design, or board URL</span>
                    </div>
                    <div class="form-group">
                        <label for="figmaTokenInput">
                            Personal Access Token
                            <span class="token-secure-badge" title="Stored in browser only — never sent to our servers">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" />
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                Local only
                            </span>
                        </label>
                        <input type="password" id="figmaTokenInput" placeholder="figd_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                            spellcheck="false">
                        <span class="input-hint">
                            <a href="https://help.figma.com/hc/en-us/articles/8085703771159" target="_blank">Create a
                                token</a>
                            — stored in your browser only
                        </span>
                    </div>
                    <button class="btn-fetch" id="fetchFileBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 12a9 9 0 1 1-6.22-8.56" />
                            <polyline points="22 2 22 8 16 8" />
                        </svg>
                        <span>Fetch Screens</span>
                    </button>

                    <!-- Pipeline status -->
                    <div class="pipeline-status" id="pipelineStatus" hidden>
                        <div class="pipeline-step" data-step="fetch" id="stepFetch">
                            <div class="step-indicator"></div>
                            <span>Fetching file…</span>
                        </div>
                        <div class="pipeline-step" data-step="select" id="stepSelect">
                            <div class="step-indicator"></div>
                            <span>Select screen</span>
                        </div>
                        <div class="pipeline-step" data-step="screenshot" id="stepScreenshot">
                            <div class="step-indicator"></div>
                            <span>Loading preview</span>
                        </div>
                        <div class="pipeline-step" data-step="generate" id="stepGenerate">
                            <div class="step-indicator"></div>
                            <span>Generating code</span>
                        </div>
                    </div>

                    <!-- Screenshot preview -->
                    <div class="screenshot-preview" id="screenshotPreview" hidden>
                        <label>Preview</label>
                        <div class="screenshot-frame">
                            <img id="screenshotImg" alt="Screen preview" />
                        </div>
                    </div>
                </div>

                <!-- JSON paste source -->
                <div class="source-panel" id="jsonPastePanel">
                    <div class="upload-zone" id="uploadZone">
                        <input type="file" id="fileInput" accept=".json" hidden>
                        <div class="upload-icon">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                <polyline points="17 8 12 3 7 8" />
                                <line x1="12" y1="3" x2="12" y2="15" />
                            </svg>
                        </div>
                        <p class="upload-text">Drop Figma JSON here or <button class="link-btn"
                                id="browseBtn">browse</button></p>
                        <p class="upload-hint">Export from Figma: File → Export as JSON</p>
                    </div>

                    <div class="form-group">
                        <label for="jsonInput">Or paste JSON directly</label>
                        <textarea id="jsonInput" placeholder='{"document": { ... }}' rows="8"
                            spellcheck="false"></textarea>
                    </div>
                </div>

                <!-- Screen selector (shared) -->
                <div class="form-group" id="screenGroup" style="display:none">
                    <label for="screenSelect">Screen / Frame</label>
                    <div class="select-wrapper">
                        <select id="screenSelect">
                            <option value="">— Select a screen —</option>
                        </select>
                        <svg class="select-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9" />
                        </svg>
                    </div>
                </div>

                <!-- AI toggle -->
                <div class="toggle-row">
                    <label class="toggle-label">
                        <span class="toggle-icon">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7z" />
                                <line x1="9" y1="21" x2="15" y2="21" />
                            </svg>
                        </span>
                        AI-Enhanced Generation
                    </label>
                    <div class="toggle-switch">
                        <input type="checkbox" id="aiToggle" checked>
                        <span class="toggle-track"></span>
                    </div>
                </div>

                <!-- Generate button -->
                <button class="btn-generate" id="generateBtn" disabled>
                    <span class="btn-text">Generate Component</span>
                    <span class="btn-spinner" hidden>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                        </svg>
                    </span>
                </button>

                <!-- Design System button -->
                <button class="btn-design-system" id="designSystemBtn" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3" />
                        <path
                            d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83" />
                    </svg>
                    <span class="btn-text">Extract Design System</span>
                    <span class="btn-spinner" hidden>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                        </svg>
                    </span>
                </button>

                <!-- Format toggle for design system -->
                <div class="format-toggle" id="formatToggle" hidden>
                    <span class="format-label">Output:</span>
                    <button class="format-btn active" data-format="css">CSS</button>
                    <button class="format-btn" data-format="scss">SCSS</button>
                </div>
            </div>
        </section>

        <!-- Right Panel: Output -->
        <section class="panel panel-output">
            <div class="panel-header">
                <h2>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="16 18 22 12 16 6" />
                        <polyline points="8 6 2 12 8 18" />
                    </svg>
                    Output
                </h2>
                <span class="component-name" id="componentName"></span>
            </div>

            <!-- Tabs -->
            <div class="code-tabs" id="codeTabs" style="display:none">
                <!-- Angular tabs -->
                <button class="tab active" data-tab="html">HTML</button>
                <button class="tab" data-tab="scss">SCSS</button>
                <button class="tab" data-tab="ts">TypeScript</button>
                <!-- Preview tab (always available) -->
                <button class="tab tab-preview" data-tab="preview">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                        <circle cx="12" cy="12" r="3" />
                    </svg>
                    Preview
                </button>
            </div>

            <div class="panel-body output-body">
                <!-- Empty state -->
                <div class="empty-state" id="emptyState">
                    <div class="empty-icon">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1">
                            <rect x="3" y="3" width="18" height="18" rx="2" />
                            <path d="M9 9l6 6M15 9l-6 6" />
                        </svg>
                    </div>
                    <p>Generated code will appear here</p>
                    <p class="empty-hint">Enter a Figma URL or upload JSON and click Generate</p>
                </div>

                <!-- Code display -->
                <div class="code-panel" id="codePanel" style="display:none">
                    <div class="code-header">
                        <span class="editor-label">Editor</span>
                        <div class="code-actions">
                            <button class="copy-btn" id="copyBtn" title="Copy to clipboard">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2" />
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                </svg>
                                <span>Copy</span>
                            </button>
                        </div>
                    </div>
                    <!-- CodeMirror container replaces <pre> -->
                    <div id="editorContainer" class="editor-container"></div>
                </div>

                <!-- Preview Panel -->
                <div class="preview-panel" id="previewPanel" style="display:none">
                    <div class="preview-content">
                        <div class="preview-toolbar">
                            <span class="preview-label">Live Preview</span>
                            <div class="preview-viewport-btns">
                                <button class="viewport-btn active" data-width="100%" title="Full width">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="2" y="3" width="20" height="14" rx="2" />
                                        <line x1="8" y1="21" x2="16" y2="21" />
                                        <line x1="12" y1="17" x2="12" y2="21" />
                                    </svg>
                                </button>
                                <button class="viewport-btn" data-width="375px" title="Mobile (375px)">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <rect x="5" y="2" width="14" height="20" rx="2" />
                                        <line x1="12" y1="18" x2="12" y2="18" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="preview-frame-wrapper">
                            <iframe id="previewFrame" class="preview-frame" sandbox="allow-same-origin allow-scripts"
                                title="Component Preview"></iframe>
                        </div>
                    </div>

                    <!-- Console Panel -->
                    <div class="console-panel" id="consolePanel">
                        <div class="console-header">
                            <span class="console-title">Console</span>
                            <button class="console-clear" id="consoleClearBtn" title="Clear console">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="15" y1="9" x2="9" y2="15"></line>
                                    <line x1="9" y1="9" x2="15" y2="15"></line>
                                </svg>
                            </button>
                        </div>
                        <div class="console-output" id="consoleOutput"></div>
                    </div>
                </div>

                <!-- Iterate Panel -->
                <div class="iterate-panel" id="iteratePanel" style="display:none">
                    <div class="iterate-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7z" />
                            <line x1="9" y1="21" x2="15" y2="21" />
                        </svg>
                        <span>Refine with AI</span>
                    </div>
                    <div class="iterate-input-row">
                        <input type="text" id="iterateInput"
                            placeholder="e.g. Make the button larger, add a dark theme..." spellcheck="false">
                        <button class="btn-iterate" id="iterateBtn">
                            <span class="btn-text">Refine</span>
                            <span class="btn-spinner" hidden>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path
                                        d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                                </svg>
                            </span>
                        </button>
                    </div>
                </div>

                <!-- Design System Results -->
                <div class="design-system-results" id="designSystemResults" style="display:none">
                    <div class="ds-header">
                        <h3>Design System Tokens</h3>
                        <div class="ds-source-badge" id="dsSourceBadge"></div>
                    </div>
                    <div class="ds-stats" id="dsStats"></div>
                    <div class="ds-css-preview">
                        <div class="ds-css-header">
                            <span>Generated Stylesheet</span>
                            <button class="copy-btn" id="dsCopyBtn" title="Copy CSS">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2" />
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                                </svg>
                                <span>Copy</span>
                            </button>
                            <button class="download-btn" id="dsDownloadBtn" title="Download file">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                                    <polyline points="7 10 12 15 17 10" />
                                    <line x1="12" y1="15" x2="12" y2="3" />
                                </svg>
                                <span>Download</span>
                            </button>
                        </div>
                        <pre class="code-block ds-code"><code id="dsCodeContent"></code></pre>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ─── Toast ───────────────────────────────────── -->
    <div class="toast" id="toast" hidden>
        <span class="toast-icon"></span>
        <span class="toast-message"></span>
    </div>

    <script src="app.js"></script>
</body>

</html>